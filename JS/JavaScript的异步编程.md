# JavaScript的异步编程

> 到了巩固基础的时间了，为了更加了解JavaScript的异步编程，还特地去了 阮一峰老师 的博客考了古。<br/>
因为我觉得即使以前的知识过期了，新的函数方法也是为了改善旧方法而出现的，我自认为学好新的知识之前不防把旧知识也好好了解了解。
本文也多处摘抄至阮一峰老师的《Javascript异步编程的4种方法》，也是为了让阮一峰老师易读的文章帮助到大家，还有供我复习的时候使用。


"从前"，JavaScript的异步编程常用有四种：
```
- 回调函数
- 事件监听
- 发布/订阅
```

在这篇章里，我主要讨论这三种。

## 异步编程的出现
Javascript语言的执行环境是"单线程"（single thread）。

所谓"单线程"，就是指一次只能完成一件任务。如果有多个任务，就必须排队，前面一个任务完成，再执行后面一个任务。

这样的话，若是有一个任务耗时很长，后面的任务都必须排队等着。<br/>
常见的场景由：浏览器无响应（假死）<br/>
往往就是因为某一段Javascript代码长时间运行（rg.死循环），导致整个页面卡在这个地方。

以上，这样的执行顺序，就是相反我们所要讨论的异步模式：`同步模式`。

"异步模式"非常重要。<br/>
在浏览器端，耗时很长的操作都应该异步执行，避免浏览器失去响应。<br/>
例如：Ajax操作。<br/>
因为执行环境是单线程的，如果允许同步执行所有http请求，服务器性能会急剧下降，很快就会失去响应。



## 一、回调函数
这是异步编程最基本的方法。

假定有两个函数f1和f2，后者等待前者的执行结果。
```
　　f1();

　　f2();
```

如果f1是一个很耗时的任务，可以考虑改写f1，把f2写成f1的回调函数。

```
　　function f1(callback){

　　　　setTimeout(function () {

　　　　　　// f1的任务代码

　　　　　　callback();

　　　　}, 1000);

　　}
  
  　　f1(f2);
```
采用这种方式，我们把之前的同步操作变成了异步操作，<br/>
f1不会堵塞程序运行，相当于先执行程序的主要逻辑，将耗时的操作推迟执行。

回调函数的优点是简单、容易理解和部署，<br/>
缺点是不利于代码的阅读和维护，各个部分之间高度耦合（Coupling），<br/>
流程会很混乱，而且每个任务只能指定一个回调函数。















而Promise、Generator、Thunk、co、Async则在我的其它文章中讨论总结。
