本文内容大多参考《图解HTTP》一书

文章多转载至 [认识HTTP----Cookie和Session篇 作者：胡秉亮]https://zhuanlan.zhihu.com/p/27669892

##1. 使用Cookie来管理状态

  HTTP 是无状态协议，说明它不能以状态来区分和管理请求和响应。也就是说，无法根据之前的状态进行本次的请求处理。
不可否认，无状态协议当然也有它的优点。由于不必保存状态，自然可减少服务器的CPU 及内存资源的消耗。从另一侧面来说，也正是因为HTTP 协议本身是非常简单的，所以才会被应用在各种场景里。

![Alt text](https://pic2.zhimg.com/80/v2-dde997503ed9d450e2f39042d53d4307_hd.jpg)

我们登录淘宝的时候首先要登录，我们看到了一个商品点进去，进行了页面跳转/刷新，按照HTTP的无状态协议岂不是又要登录一次？
所以为了解决这个问题，Cookie诞生了，在**保留无状态协议这个特征的同时又要解决类似记录状态的矛盾问题**。Cookie 技术通过在*请求和响应报文*中写入Cookie 信息来控制客户端的状态。
Cookie 会根据从服务器端发送的响应报文内的一个叫做Set-Cookie的首部字段信息，通知客户端保存Cookie。当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入Cookie 值后发送出去。
服务器端发现客户端发送过来的Cookie 后，会去检查究竟是从哪一个客户端发来的连接请求，然后对比服务器上的记录，最后得到之前的状态信息。

  没有Cookie信息状态下的请求（如下图）

  ![Alt text](https://pic4.zhimg.com/80/v2-85622297a93f493c891ffb90b67fd5e0_hd.jpg)
  
  第2次以后（存有Cookie信息状态）的请求（如下图）
  
  ![Alt text](https://pic4.zhimg.com/80/v2-1f49734871c5e2da2d264d28ac310a65_hd.jpg)
  
  上图很清晰地展示了发生Cookie 交互的情景。
  HTTP 请求报文和响应报文的内容如下（数字和图中对应）。
  
  ①请求报文（没有Cookie 信息的状态）



































cookie 和session 的区别：

1、cookie数据存放在客户的浏览器上，session数据放在服务器上。

2、cookie不是很安全，别人可以分析存放在本地的COOKIE并进行COOKIE欺骗
   考虑到安全应当使用session。

3、session会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能
   考虑到减轻服务器性能方面，应当使用COOKIE。

4、单个cookie保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个cookie。

5、所以个人建议：
   将登陆信息等重要信息存放为SESSION
   其他信息如果需要保留，可以放在COOKIE中





